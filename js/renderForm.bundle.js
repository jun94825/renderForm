!function(n){var e={};function t(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return n[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=n,t.c=e,t.d=function(n,e,i){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:i})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var a in n)t.d(i,a,function(e){return n[e]}.bind(null,a));return i},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(n,e,t){"use strict";t.r(e);var i=Vue.extend({props:["data","index","ScoreEnable","pMode"],template:'\n    <div class="question" v-if="display">\n      <div>\n        <span v-if="data.Required" class="badge badge-danger mr-1">必填</span>\n        <h5 class="d-inline">{{ index + 1 }}. {{ data.Title }} : </h5>\n      </div>\n      <div class="d-flex align-items-center flex-wrap">\n        <div\n          class="d-flex align-items-center mt-3"\n          v-for="(item, index) in data.Options"\n          :key="index"\n        >\n          <input\n            :type="data.Type"\n            :id="item.Guid"\n            :value="item.Guid"\n            v-model="data.Answer"\n            @change="checkBinding(data, item)"\n          />\n          <label :for="item.Guid">{{ item.Value }}</label>\n        </div>\n      </div>\n    </div>\n  ',data:function(){return{display:!0}},mounted:function(){var n=this;eventBus.$on("connect",(function(e){e.Guid===n.data.Guid&&(n.display=e.status)}))}}),a=(Vue.component("radio",{watch:{display:function(){this.display||(this.data.Answer="",this.data.Options.forEach((function(n){n.Binding.length>0&&n.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!1})}))})))}},methods:{checkBinding:function(n,e){this.ScoreEnable&&this.pMode&&this.$emit("show"),e.Binding.length>0?e.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!0})})):n.Options.forEach((function(n){n.Binding.length>0&&n.Guid!==e.Guid&&(console.log("False"),n.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!1})})))}))}},extends:i}),Vue.component("checkbox",{watch:{display:function(){this.display||(this.data.Answer=[],this.data.Options.forEach((function(n){n.Binding.length>0&&n.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!1})}))})))}},methods:{checkBinding:function(n,e){this.ScoreEnable&&this.pMode&&this.$emit("show"),e.Binding.length>0&&e.Binding.forEach((function(t){0===n.Answer.length?eventBus.$emit("connect",{Guid:t,status:!1}):n.Answer.forEach((function(n){n===e.Guid?eventBus.$emit("connect",{Guid:t,status:!0}):eventBus.$emit("connect",{Guid:t,status:!1})}))}))}},extends:i}),Vue.extend({props:["data","index","ScoreEnable","pMode"],data:function(){return{display:!0}},watch:{display:function(){this.display||(this.data.Answer="")}},mounted:function(){var n=this;eventBus.$on("connect",(function(e){e.Guid===n.data.Guid&&(n.display=e.status)}))}}));Vue.component("dropdown",{template:'\n    <div class="question" v-if="display">\n      <div class="d-flex align-items-center flex-wrap">\n        <div>\n          <span v-if="data.Required" class="badge badge-danger mr-1">必填</span>\n          <h5 class="d-inline">{{ index + 1 }}. {{ data.Title }} : </h5>\n        </div>\n        <select class="dropdown form-control" v-model="data.Answer" @change="hello">\n          <option value="">請選擇</option>\n          <option\n            v-for="(item, index) in data.Options"\n            :key="index"\n            :value="item.Guid"\n            >{{ item.Value }}</option\n          >\n        </select>\n      </div>\n    </div>\n  ',methods:{hello:function(){this.ScoreEnable&&this.pMode&&this.$emit("show")}},extends:a}),Vue.component("literal",{template:'\n    <div class="question" v-if="display">\n      <div class="d-flex align-items-center flex-wrap">\n        <div>\n          <span v-if="data.Required" class="badge badge-danger mr-1">必填</span>\n          <h5 class="d-inline">{{ index + 1 }}. {{ data.Title }} : </h5>\n        </div>\n        <div class="input literal mt-2 mt-md-0 ml-3 ml-md-2">\n          <input type="text" v-model="data.Answer" placeholder="您的回答" />\n          <div class="line"></div>\n        </div>\n      </div>\n    </div>\n  ',extends:a}),Vue.component("date",{template:'\n    <div class="question" v-if="display">\n      <div class="d-flex align-items-center flex-wrap">\n        <div>\n        <span v-if="data.Required" class="badge badge-danger mr-1">必填</span>\n          <h5 class="d-inline">{{ index + 1 }}. {{ data.Title }} : </h5>\n        </div>\n        <div class="mt-2 mt-md-0 ml-3 ml-md-2">\n          <input type="date" class="date form-control" v-model="data.Answer"/>\n        </div>\n      </div>\n    </div>\n  ',extends:a}),Vue.component("number",{template:'\n    <div class="question" v-if="display">\n      <div class="d-flex align-items-center flex-wrap">\n        <div>\n          <span v-if="data.Required" class="badge badge-danger mr-1">必填</span>\n          <h5 class="d-inline">{{ index + 1 }}. {{ data.Title }} : </h5>\n        </div>\n        <div class="input literal mt-2 mt-md-0 ml-3 ml-md-2">\n          <input type="number" class="form-control" v-model="data.Answer" />\n          <div class="line"></div>\n        </div>\n      </div>\n    </div>\n  ',extends:a}),Vue.component("email",{template:'\n    <div class="question" v-if="display">\n      <div class="d-flex align-items-center flex-wrap">\n        <div>\n          <span v-if="data.Required" class="badge badge-danger mr-1">必填</span>\n          <h5 class="d-inline">{{ index + 1 }}. {{ data.Title }} : </h5>\n        </div>\n        <div class="input literal mt-2 mt-md-0 ml-3 ml-md-2">\n          <input type="email" class="mt-1" v-model="data.Answer" placeholder="請輸入您的 E-mail" />\n          <div class="line"></div>\n        </div>\n      </div>\n    </div>\n  ',extends:a}),Vue.component("english",{template:'\n    <div class="question" v-if="display">\n      <div class="d-flex align-items-center flex-wrap">\n        <div>\n          <span v-if="data.Required" class="badge badge-danger mr-1">必填</span>\n          <h5 class="d-inline">{{ index + 1 }}. {{ data.Title }} : </h5>\n        </div>\n        <div class="input literal mt-2 mt-md-0 ml-3 ml-md-2">\n          <input type="english" class="mt-1" v-model="data.Answer" placeholder="請輸入英文字母" @change="checkNum" />\n          <div class="line"></div>\n        </div>\n      </div>\n    </div>\n  ',methods:{checkNum:function(){this.data.Answer=this.data.Answer.replace(/[^\a-\z\A-\Z]/g,"")}},extends:a});Vue.component("render-form",{data:function(){return{form:{},totalScore:0,readOnlyMode:!1,previewMode:!1}},template:'\n    <div>\n      <div class="container">\n        <div class="row no-gutters">\n          <div class="col">\n\n            <h4 v-if="totalScore !== 0" class="text-right">得分：<span class="badge badge-info">{{ totalScore }}</span></h4>\n            \n            <div class="title">\n              <p>{{ form.Title }}</p>\n            </div>\n            <div class="description">\n              <p>{{ form.Description }}</p>\n            </div>\n            <component\n              v-for="(item, index) in form.Questions"\n              :key="index"\n              :data="item"\n              :index="index"\n              :is="item.Type"\n              :id="item.Guid"\n              :ScoreEnable="form.ScoreEnable"\n              @show="showScore"\n              :pMode="previewMode"\n            ></component>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',watch:{form:function(){var n=this;this.$nextTick((function(){n.form.Questions.forEach((function(n){"checkbox"!==n.Type?n.Options.forEach((function(e){n.Answer===e.Guid?e.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!0})})):e.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!1})}))})):0===n.Answer.length?n.Options.forEach((function(n){n.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!1})}))})):n.Answer.forEach((function(e){n.Options.forEach((function(n){e!==n.Guid&&n.Binding.forEach((function(n){eventBus.$emit("connect",{Guid:n,status:!1})}))}))}))}))}))},readOnlyMode:function(){this.readOnlyMode&&(Array.from(document.querySelectorAll("input")).forEach((function(n){n.disabled=!0})),Array.from(document.querySelectorAll("select")).forEach((function(n){n.disabled=!0})))}},methods:{getFormJSON:function(){var n=JSON.parse(JSON.stringify(this.form));this.form.Questions.forEach((function(n){if("checkbox"!==n.Type)if(n.Answer.length>0){var e=[];e.push(n.Answer),n.Answer=e}else n.Answer=[]}));var e=JSON.stringify(this.form);return this.form=n,e},renderForm:function(n){n.Questions.forEach((function(n){"checkbox"!==n.Type&&(1===n.Answer.length?n.Answer=n.Answer[0]:n.Answer="")})),this.form=n},checkRequired:function(){return!this.form.Questions.filter((function(n){return document.getElementById(n.Guid)})).some((function(n){return n.Required&&0===n.Answer.length}))},checkEmail:function(){var n=this,e=this.form.Questions.filter((function(n){return"email"===n.Type})),t=!0;return e.forEach((function(e){n.validateEmail(e.Answer)||(t=!1)})),t},validateEmail:function(n){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())},showScore:function(){var n=this;if(!this.form.ScoreEnable)return console.error("表單尚未開啟計分功能"),!1;this.totalScore=0,this.form.Questions.filter((function(n){return"radio"===n.Type||"checkbox"===n.Type||"dropdown"===n.Type})).forEach((function(e){"checkbox"===e.Type?e.Answer.forEach((function(t){e.Options.forEach((function(e){t===e.Guid&&(n.totalScore+=parseInt(e.Score))}))})):e.Options.forEach((function(t){e.Answer===t.Guid&&(n.totalScore+=parseInt(t.Score))}))}))},openReadOnlyMode:function(){this.readOnlyMode=!0},openPreviewMode:function(){this.previewMode=!0}}});var d=new Vue({el:"#app"});window.jun={getRenderFormJS:d.$refs.jun.getFormJSON,renderForm:d.$refs.jun.renderForm,checkRequired:d.$refs.jun.checkRequired,checkEmail:d.$refs.jun.checkEmail,openReadOnlyMode:d.$refs.jun.openReadOnlyMode,showScore:d.$refs.jun.showScore,openPreviewMode:d.$refs.jun.openPreviewMode}}]);